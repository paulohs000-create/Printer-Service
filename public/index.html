<!DOCTYPE html>
<html>
<head>
    <title>Printer Test</title>
</head>
<body>

    <h2>Teste Impressão 58mm</h2>
    <button onclick="imprimir()">Imprimir</button>

    <script src="https://cdn.jsdelivr.net/npm/qz-tray/qz-tray.js"></script>

    <script>

        async function conectarQZ() {
            if (!qz.websocket.isActive()) {
                await qz.websocket.connect();
                console.log("Conectado ao QZ");
            }
        }

        async function imprimir() {
            try {

                await conectarQZ();

                const config = qz.configs.create("S260M"); // nome exato no Windows

                const dados = [
                    '\x1B\x40',
                    'PRINTER SERVICE TESTE\n',
                    '--------------------------\n',
                    'Item 1        10.00€\n',
                    'Item 2        20.00€\n',
                    '--------------------------\n',
                    'TOTAL:        30.00€\n\n\n',
                    '\x1D\x56\x00' // CORTE
                ];

                await qz.print(config, dados);

            } catch (err) {
                alert("Erro ao imprimir: " + err);
            }
        }

    </script>

</body>
</html>
